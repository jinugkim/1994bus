# 🚌 버스 좌석 예약 시스템 - 구글 시트 연동 가이드

## 📋 개요
이 시스템은 구글 스프레드시트를 데이터베이스로 활용하여 28인승 버스의 좌석 예약을 관리하는 웹 애플리케이션입니다.

## 🛠️ 구글 API 설정

### 1. Google Cloud Console 프로젝트 생성
1. [Google Cloud Console](https://console.cloud.google.com/) 접속
2. 새 프로젝트 생성 또는 기존 프로젝트 선택
3. 프로젝트 이름: `bus-reservation-system`

### 2. Google Sheets API 활성화
1. **API 및 서비스** → **라이브러리** 이동
2. **Google Sheets API** 검색 및 활성화
3. **Google Drive API**도 함께 활성화 (권한 관리용)

### 3. 인증 정보 생성

#### API 키 생성
1. **API 및 서비스** → **인증 정보** 이동
2. **+ 인증 정보 만들기** → **API 키** 선택
3. 생성된 API 키 복사

#### OAuth 2.0 클라이언트 ID 생성
1. **+ 인증 정보 만들기** → **OAuth 클라이언트 ID** 선택
2. 애플리케이션 유형: **웹 애플리케이션**
3. **승인된 JavaScript 원본** 추가:
   - `http://localhost:8001` (개발용)
   - `https://yourdomain.com` (배포용)
4. 생성된 클라이언트 ID 복사

### 4. 구글 스프레드시트 생성
1. [Google Sheets](https://sheets.google.com) 접속
2. 새 스프레드시트 생성
3. 시트 이름을 `BusReservations`로 변경
4. URL에서 스프레드시트 ID 복사
   ```
   https://docs.google.com/spreadsheets/d/[SPREADSHEET_ID]/edit
   ```

### 5. 스프레드시트 권한 설정
1. 스프레드시트에서 **공유** 버튼 클릭
2. **일반 액세스**를 **링크가 있는 모든 사용자**로 설정
3. 권한: **편집자**

## ⚙️ 코드 설정

### `sheets-api.js` 파일 수정
```javascript
// 다음 값들을 실제 값으로 교체하세요:
this.API_KEY = 'YOUR_API_KEY_HERE';
this.CLIENT_ID = 'YOUR_CLIENT_ID_HERE';
this.SPREADSHEET_ID = 'YOUR_SPREADSHEET_ID_HERE';
```

## 🚀 사용 방법

### 1. 시스템 시작
```bash
python -m http.server 8001
```

### 2. 웹 브라우저에서 접속
```
http://localhost:8001
```

### 3. 구글 시트 연동
1. **"📋 예약 현황 불러오기"** 버튼 클릭
2. 구글 계정으로 로그인
3. 권한 승인

### 4. 좌석 예약
1. **빈 좌석 클릭** → 예약 정보 입력
2. **예약된 좌석 클릭** → 취소 정보 입력

## 📊 스프레드시트 구조

| A | B | C | D | E | F |
|---|---|---|---|---|---|
| 좌석번호 | 이름 | 전화번호 | 탑승지 | 입금상태 | 예약시간 |
| 1 | 김진욱 | 010-1234-5678 | 양재 | paid | 2024-01-01T12:00:00Z |

## 🎯 주요 기능

### ✅ 예약 기능
- 빈 좌석 클릭하여 예약
- 이름, 전화번호, 탑승지, 입금상태 입력
- 실시간 구글 시트 동기화

### ✅ 취소 기능
- 예약된 좌석 클릭
- 이름과 전화번호로 본인 확인
- 일치시에만 취소 가능

### ✅ 시각화 기능
- 탑승지별 색상 구분
- 입금상태별 투명도 조절
- 실시간 통계 표시

### ✅ 관리 기능
- 예약 현황 불러오기
- 모든 예약 일괄 삭제
- 텍스트 일괄 입력 지원

## 🔧 문제 해결

### API 오류
- **403 Forbidden**: API 키 또는 권한 확인
- **404 Not Found**: 스프레드시트 ID 확인
- **CORS 오류**: localhost에서 테스트

### 연동 실패
1. 브라우저 콘솔에서 오류 메시지 확인
2. API 키와 클라이언트 ID 재확인
3. 스프레드시트 공유 권한 확인

### 예약 저장 실패
1. 구글 계정 로그인 상태 확인
2. 스프레드시트 편집 권한 확인
3. 시트 이름이 `BusReservations`인지 확인

## 📱 모바일 지원
- 반응형 디자인으로 모바일에서도 사용 가능
- 터치 친화적 인터페이스
- 모바일 브라우저에서 구글 로그인 지원

## 🔒 보안 고려사항
- API 키는 클라이언트 측에서만 사용 (읽기 전용 권장)
- OAuth를 통한 안전한 인증
- 스프레드시트 공유 범위 최소화

## 📞 지원
문제가 발생하면 다음을 확인해주세요:
1. 구글 API 콘솔에서 할당량 확인
2. 브라우저 개발자 도구의 네트워크 탭 확인
3. 구글 시트의 편집 기록 확인
